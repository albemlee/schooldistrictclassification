---
title: "Part 2"
output: html_notebook
---

# Setup Notebook

```{r setup, results='hide'}
knitr::opts_knit$set(root.dir = '..')
devtools::install_github("tidyverse/ggplot2") #version with stat_qq_line

# Load requirements
library(dplyr)
library(tidyr)
library(ggplot2)
```

# How much data is available?

The dataset is a wrangled version of the 2010 common core dataset from NCES. The wrangling steps are documented in [Part_1.ipynb](https://github.com/albemlee/schooldistrictclassification/blob/master/notebooks/Part_1.ipynb). There should be 365 variables and 18,175 observations.

```{r}
# Load data
data <- read.csv('outputs/encoded_data_2010.csv')
data <- data %>% mutate_if(is.integer,as.numeric)
print(dim(data))
```

# How much data is missing?

Prior to this analysis, the dataset was already wrangled and variables with more than half the values missing were removed. As a sanity check, I made sure the wrangled dataset does not contain too many missing values.

```{r}
print(paste('Total Cells', 18175*356, sep=': '))
print(paste('Total Missing Cells', sum(is.na(data)), sep=': '))
print(paste('Proportion of Cells Missing', sum(is.na(data))/(18175*356), sep=': '))
```

Over 20 percent of the cells are missing. Next, I want to know which columns have the most missing values. Given that this dataset was already wrangled, no column should have more than 9,100 missing values.

```{r}
missing_value_counts = c()

for(column in names(data)){
  missing_value_counts <- c(missing_value_counts, (sum(is.na(select(data, column)))))
}

missing_value_counts = data.frame(names(data), missing_value_counts)
names(missing_value_counts) <- c('column', 'missing_value_count')
print(
  paste(
    'Columns with over 9,100 missing values:',
    nrow(missing_value_counts %>%
             filter(missing_value_count > 9100) %>%
             select(column))
  ))
```

There are no columns with over 9,100 missing values. Let's see the distribution of missing values.

```{r}
ggplot(missing_value_counts, aes(missing_value_count)) +
  geom_histogram(binwidth=500)
```

```{r}
missing_value_counts %>%
  filter(missing_value_count < 1500) %>%
  select(column)
```
